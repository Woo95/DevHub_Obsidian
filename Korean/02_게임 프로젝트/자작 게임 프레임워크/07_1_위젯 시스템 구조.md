# **위젯 시스템 구조**
---
## **개요**
위젯 시스템은 **계층 구조로 UI를 관리하고 입력 처리를 수행**합니다. `CUserWidget`을 상속받아 **사용자 정의 위젯**을 쉽게 만들 수 있으며, `CWidget`을 상속하여 만든 [[07_2_기본 제공 위젯 구성|기본 제공 위젯]]과 함께 드래그 등 기본 상호작용 기능도 이미 구현되어 있어 **간단히 적용 가능한 개발 친화적 UI**를 제공합니다.

![[Self-Made Game Framework (Media)#^eabc68]]

---
## **위젯 입력 처리 시스템 흐름도 | [[Widget Input System Architecture Diagram_Kor.png|자세히 보기]]**
![[Widget Input System Architecture Diagram_Kor.png]]

본 흐름도는 위젯 시스템의 **업데이트 및 입력 처리 흐름 과정**을 보여줍니다.

---
## **위젯 관련 클래스 목록 및 설명**
### `1. CSceneUI 클래스` | [**저장소 보기**](https://github.com/Woo95/SDL2_Game_Framework/blob/main/Template/Client/Include/Scene/Extension/SceneUI.h)
![[Self-Made Game Framework (Code)#^e06264]]
- **역할**:
    - **씬 UI를 관리**하며, 마우스 입력을 받아 **위젯과 상호작용을 처리**하는 클래스입니다.
- **핵심 변수들**:
    - `mWidgets`:
	    - **씬 UI에 직접 등록된 최상위 위젯 목록**입니다.
    - `mCurrHovered`:
	    - **마우스 커서와 닿아 있는 위젯**입니다.
    - `mHeldWidget`:
	    - **마우스로 홀드 중인 위젯**입니다.
- **핵심 함수들**:
	- [[Self-Made Game Framework (Code)#^7bf0af|CWidget* FindHoveredWidget(const FVector2D& mousePos)]]:
		- **마우스 커서와 닿아 있는 위젯**의 포인터를 반환합니다.
	- [[Self-Made Game Framework (Code)#^5cc348|void UpdateInput()]]:
		- **마우스 위치와 버튼 상태를 확인**하여, 홀드 중인 위젯이 영역을 벗어나면 **호버 해제 함수를 호출**하고, 새로 호버된 위젯이 있으면 **호버 함수를 호출**합니다.

---
### `2. CWidget 클래스` | [**저장소 보기**](https://github.com/Woo95/SDL2_Game_Framework/blob/main/Template/Client/Include/Widget/Widget.h)
![[Self-Made Game Framework (Code)#^50ddf5]]
- **역할**:
	- 모든 [[07_2_기본 제공 위젯 구성|기본 제공 위젯]]의 부모 클래스이며, **추상화** 클래스입니다.
	- **계층 구조**를 기반으로, UI를 구조적으로 관리하고 **확장성을 높입니다**.
	- 모든 위젯의 **상호작용 기능을 제공**합니다.
- **핵심 변수들**:
	- `mParent`:
		- 현재 위젯의 **부모 위젯**입니다.
	- `mChilds`:
		- 현재 위젯의 **자식 위젯들**입니다.
- **핵심 함수들**:
	- `virtual void HandleHovered(const FVector2D&, bool, bool, bool)`:
		- **마우스가 위젯 위에 있을 때** 호출되는 **가상 함수**입니다.
	- `virtual void HandleUnhovered(const FVector2D&, bool, bool)`:
		- **마우스가 위젯에서 벗어날 때** 호출되는 **가상 함수**입니다.

---
### `3. CUserWidget 클래스` | [**저장소 보기**](https://github.com/Woo95/SDL2_Game_Framework/blob/main/Template/Client/Include/Widget/UserWidget.h)
![[Self-Made Game Framework (Code)#^93523d]]
- **역할**:
	- **사용자 정의 위젯**의 부모 클래스이며, **추상화** 클래스입니다.
	- **마우스 드래그**와 같은 **기본 상호작용 기능**을 제공합니다.
- **핵심 변수들**:
	- `mIsMovable`:
		- 위젯이 **드래그 가능**한지 여부를 나타냅니다.
	- `mDragOffset`:
		- 드래그 시, **마우스와 위젯 위치 차이**를 저장합니다.
- **핵심 함수들**:
	- [[Self-Made Game Framework (Code)#^3df818|void HandleDragging(const FVector2D&, bool, bool, bool)]]:
		- 마우스 클릭시, 위젯을 **드래그 처리**합니다.
			- **드래그 시작**: 마우스를 누르고 위젯을 최상단으로 이동합니다.
			- **드래그 진행**: 마우스 위치에 따라 위젯 위치를 갱신합니다.
			- **드래그 종료**: 마우스를 놓고 드래그를 종료합니다.

---
## **맺는 말**
> 위젯 시스템은 **계층 구조 기반 UI 관리**로 구조를 명확히 하고, **입력 처리와 상호작용 기능**을 통합하여 직관적인 UI 구성을 지원합니다. 언리얼 엔진과 유사한 구조로 설계하여, **기본 제공 위젯과 사용자 정의 위젯을 만들며 UI 계층 구조가 실제로 어떻게 동작하는지** 이해할 수 있었습니다.