# **씬-레이어-오브젝트-컴포넌트 계층 구조**
---
## **개요**
이 구조는 `씬(Scene) → 레이어(Layer) → 오브젝트(Object) → 컴포넌트(Component)` 순으로 구성됐습니다. **객체지향 설계 원칙**을 바탕으로 각 단계의 **역할을 명확히 구분**하며, **효율적인 관리**와 **유연한 확장성**을 함께 제공합니다.

---
## **계층 구조 설계도**
![[Scene-Layer-Object-Component Hierarchy_Kor.png]]

이 설계도는 각 클래스의 계층 구조를 시각적으로 보여줍니다.

---
## **클래스 목록 및 설명**

> ⚠️ 참고: 씬-레이어-오브젝트-컴포넌트 계층 구조 설명을 위해 **간소화한 코드**입니다.
### `1. CScene 클래스`
![[Self-Made Game Framework (Code)#^36e7b4]]
- **역할**:
    - 모든 씬 클래스가 상속받는 **추상 클래스**입니다.
    - **여러 레이어**를 보유하며, 레이어는 배경, 오브젝트 등 **순차적으로 그려야 하는 요소를 구분**합니다.
- **핵심 함수들**:
	- [[Self-Made Game Framework (Code)#^31e555|CScene()]]:
		- 씬 생성자. 레이어를 [[메모리 풀 라이브러리|메모리 풀]]에서 생성 및 초기화합니다.
	- [[Self-Made Game Framework (Code)#^1b2665|virtual ~CScene()]]:
		- 씬 소멸자. 레이어 메모리를 해제하되, [[메모리 풀 라이브러리|메모리 풀]]은 유지합니다.
	- [[Self-Made Game Framework (Code)#^0c3634|virtual void Update(float deltaTime)]]:
		- 씬 구성 요소(레이어, 충돌 시스템, 카메라, UI)를 업데이트합니다.
	- [[Self-Made Game Framework (Code)#^c1f92b|virtual void LateUpdate(float deltaTime)]]:
		- 씬 구성 요소(레이어, 충돌 시스템, UI)를 지연 업데이트합니다.
	- [[Self-Made Game Framework (Code)#^8dbf95|virtual void Render(SDL_Renderer* renderer)]]:
		- 씬 구성 요소(레이어, UI)를 렌더합니다.
	- [[Self-Made Game Framework (Code)#^144420|T* InstantiateObject\<T, int\>(const std::string& name, ELayer::Type type)]]:
		- [[메모리 풀 라이브러리|메모리 풀]]을 사용하여 오브젝트를 생성합니다.
			- 오브젝트의 초기화 함수 성공시, 지정한 레이어 타입에 등록합니다.
			- 오브젝트의 초기화 함수 실패시, 메모리를 다시 풀에 반환합니다.

---
### `2. CLayer 클래스`
![[Self-Made Game Framework (Code)#^70bdb1]]
- **역할**:
	- 레이어에 속한 모든 오브젝트를 관리하는 클래스입니다.
		- 오브젝트를 순차적으로 업데이트, 지연 업데이트, 렌더하며 필요 시 **Y축 정렬**을 수행합니다.
- **핵심 함수들**:
	- [[Self-Made Game Framework (Code)#^65f9d6|~CLayer()]]:
		- 레이어 소멸자. 소속된 모든 오브젝트를 [[메모리 풀 라이브러리|메모리 풀]]을 통해 해제합니다.
	- [[Self-Made Game Framework (Code)#^d0565b|void Update(float deltaTime)]]:
		- 오브젝트를 순차적으로 업데이트합니다.
			- !Active 상태인 오브젝트는 제거 대상으로 표시합니다.
			- !Enable 상태인 오브젝트는 업데이트를 건너뜁니다.
	- [[Self-Made Game Framework (Code)#^e4106e|void LateUpdate(float deltaTime)]]:
		- 오브젝트를 역순으로 지연 업데이트합니다.
			- !Active 상태인 오브젝트는 제거 후, [[메모리 풀 라이브러리|메모리 풀]]에 반환합니다.
			- !Enable 상태인 오브젝트는 지연 업데이트를 건너뜁니다.
	- [[Self-Made Game Framework (Code)#^549045|void Render(SDL_Renderer* renderer)]]:
		- Y축 정렬이 설정된 경우, 모든 오브젝트를 Y좌표 값 기준으로 1회 정렬합니다.
		- 오브젝트를 순차적으로 렌더합니다.
			- !Active 또는 !Enable 상태인 오브젝트는 렌더를 건너뜁니다.

---
### `3. CObject 클래스`
![[Self-Made Game Framework (Code)#^24ed16]]
- **역할**:
    - 씬과 레이어에 속하는 모든 오브젝트 클래스가 상속받는 **추상 클래스**입니다.
    - 오브젝트는 최상위 컴포넌트 `mRootComponent`를 중심으로 **컴포넌트 계층을 구성**합니다.
	    - `mRootComponent`를 업데이트, 지연 업데이트, 렌더합니다.
- **핵심 변수**:
	- `CComponent* mRootComponent`:
		- 오브젝트의 최상위 컴포넌트, `CTransform`을 포함한 전체 컴포넌트 계층의 시작점입니다.
- **핵심 함수들**:
	- [[Self-Made Game Framework (Code)#^b8195f|CObject()]]:
		- 오브젝트 생성자. 최상위 컴포넌트를 생성 및 초기화합니다.
	- [[Self-Made Game Framework (Code)#^b2dfbe|virtual ~CObject()]]:
		- 오브젝트 소멸자. 최상위 컴포넌트를 제거합니다.
	- [[Self-Made Game Framework (Code)#^6c4ee4|virtual void Init()]]:
		- 최상위 루트 컴포넌트의 초기화 함수를 호출합니다.
	- [[Self-Made Game Framework (Code)#^321393|virtual void Update(float deltaTime)]]:
		- 최상위 루트 컴포넌트의 업데이트 함수를 호출합니다.
	- [[Self-Made Game Framework (Code)#^2a3d8a|virtual void LateUpdate(float deltaTime)]]:
		- 최상위 루트 컴포넌트의 지연 업데이트 함수를 호출합니다.
	- [[Self-Made Game Framework (Code)#^fba18c|virtual void Render(SDL_Renderer* renderer)]]:
		- 최상위 루트 컴포넌트를 렌더합니다.
	- [[Self-Made Game Framework (Code)#^ab3424|T* AllocateComponent\<T\>(const std::string& name)]]:
		- [[메모리 풀 라이브러리|메모리 풀]]을 사용하여 컴포넌트를 생성합니다.
---
### `4. CComponent 클래스`
![[Self-Made Game Framework (Code)#^47760c]]
- **역할**:
	- 오브젝트의 실질적 기능을 수행하는 모든 컴포넌트가 상속받는 클래스입니다.
	- **컴포넌트 계층 구조를 관리**하며, 다른 컴포넌트를 **자식으로 포함**할 수 있습니다.
- **핵심 함수들**:
	- [[Self-Made Game Framework (Code)#^750ae3|CComponent()]]:
		- 컴포넌트 생성자. 트랜스폼을 [[메모리 풀 라이브러리|메모리 풀]]에서 생성 및 초기화합니다.
	- [[Self-Made Game Framework (Code)#^0e00e0|virtual ~CComponent()]]:
		- 컴포넌트 소멸자. 모든 자식 컴포넌트와 트랜스폼을 [[메모리 풀 라이브러리|메모리 풀]]에 반환합니다.
	- [[Self-Made Game Framework (Code)#^3286fc|virtual bool Init()]]:
		- 모든 자식 컴포넌트의 초기화 함수를 호출하며, 중간에 실패하면 false를 반환합니다.
	- [[Self-Made Game Framework (Code)#^34b1f6|virtual void Update(float deltaTime)]]:
		- 컴포넌트를 순차적으로 업데이트합니다.
			- !Active 상태인 컴포넌트는 제거 대상으로 표시합니다.
			- !Enable 상태인 컴포넌트는 업데이트를 건너뜁니다.
	- [[Self-Made Game Framework (Code)#^d23f4e|virtual void LateUpdate(float deltaTime)]]:
		- 컴포넌트를 역순으로 지연 업데이트합니다.
			- !Active 상태인 컴포넌트는 제거 후, [[메모리 풀 라이브러리|메모리 풀]]에 반환합니다.
				- 이 과정에서 트랜스폼 계층 관계도 함께 정리됩니다.
			- !Enable 상태인 컴포넌트는 지연 업데이트를 건너뜁니다.
	- [[Self-Made Game Framework (Code)#^7c581f|virtual void Render(SDL_Renderer* renderer)]]:
		- 컴포넌트를 순차적으로 렌더합니다.
			- !Active 또는 !Enable 상태인 컴포넌트는 렌더를 건너뜁니다.
- **특징**:
	- 해당 컴포넌트 클래스는 계층 구조를 유연하게 구성할 수 있으며, 이미지는 그 예시를 보여줍니다.
	  ![[Component Hierarchy_Kor.png]]
---
## **맺는 말**
> 씬-레이어-오브젝트-컴포넌트 **계층 구조를 설계**하면서 **객체지향 설계 원칙**을 **실무적으로 적용**하는 경험을 쌓을 수 있었습니다. 이를 통해 **복잡한 게임 요소를 체계적으로 구성하고 관리**하며, **유지보수와 확장**이 한층 더 용이함을 확인했습니다.